#!/bin/sh

# symbolic link dotfiles ASSUMING dotfiles reside at ~/.dotfiles

# create backups before linking
mv ~/.zshrc ~/.zshrc.bak
mv ~/.vimrc ~/.vimrc.bak

# link dotfiles
ln -s ~/.dotfiles/zsh/.zshrc ~/.zshrc
ln -s ~/.dotfiles/vim/.vimrc ~/.vimrc

# force link *.zsh files to $ZSH/custom to be loaded by oh-my-zsh
for f in zsh/*.zsh
do
  ln -sf ~/.dotfiles/"$f" "$ZSH"/custom/"$f"
done

# make sure all plugins pulled in from .gitmodules are present
git submodule update --init

# delete/copy zsh plugins to $ZSH/custom/plugins
rm -rf "$ZSH"/custom/plugins/*
rsync -a zsh/plugins/ "$ZSH"/custom/plugins
